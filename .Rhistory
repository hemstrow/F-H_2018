aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = e2.mean[[2]], y = e2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
lates[lates$Population.x == 'E' & lates$Generation.x == 2,]
lates$Generation.x
lates[lates$Population.x == 'E',]
lates$Population.x
lates[lates$Population.x == 'North_America',]
ggplot(lates[lates$Population.x == 'North_America',],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
E2.all.trials <- ggplot(all_trials[all_trials$Population == 'E' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
geom_bar(stat = 'identity', aes(x = e2.mean[[2]], y = e2.mean[[1]]/100), width = 0.3, col = 'red')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North America Post 10/3 Eclosion')+theme(plot.title = element_text(size = 16, hjust = 0.5))
ggplot(lates[lates$Population.x == 'North_America',],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('North American Post-10/3 Emergences')+theme(plot.title = element_text(size = 16, hjust = 0.5))
lates[lates$Population.x == 'North_America',]
lates.nam = lates[lates$Population.x == 'North_America',]
Data = lates.nam
meanvec=na.omit(Data$Vec)
Rs=na.omit(Data$R)
meanvec_radians = rad(meanvec)
X_coord = cos(meanvec_radians)
Y_coord = sin(meanvec_radians)
weighted_X_coord = X_coord * Rs
weighted_Y_coord = Y_coord * Rs
Data$X <- weighted_X_coord
Data$Y <- weighted_Y_coord
write.csv(Data, file = '~/Desktop/2020_monarch_orientation/later.E2', row.names = F)
Find_group_mean("~/Desktop/2020_monarch_orientation/later.E2.csv")
write.csv(Data, file = '~/Desktop/2020_monarch_orientation/later.E2.csv', row.names = F)
Find_group_mean("~/Desktop/2020_monarch_orientation/later.E2.csv")
which(lates.nam$Vector_Direction > 0 & lates.nam$Vector_Direction < 10)
lates.nam[which(lates.nam$Vector_Direction > 0 & lates.nam$Vector_Direction < 10),]
bbz <- combined.orientation2[combined.orientation2$age_during_trial < 14,]
ggplot(bbz[bbz$Population == 'E' & all_trials$Cohort == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz
table(bbz$population)
ggplot(bbz[bbz$Population.x == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz$Population.x
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial < 10,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial > 20,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial > 30,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
bbz <- combined.orientation2[combined.orientation2$age_during_trial > 40,]
ggplot(bbz[bbz$population == 'E' & bbz$Generation.x == 2,],
aes(x = Vector_Direction, y = R))+
coord_polar(theta = "x", start = 0, direction = 1)+
scale_x_continuous(breaks = c(-90, 0, 90, 180, 270, 360), limits = c(0,360))+
geom_bar(stat = 'identity', width = 0.3, col = 'black')+
theme_bw()+
theme(axis.title = element_blank(), axis.ticks = element_blank(), axis.text.y = element_blank())+
ggtitle('Babies Autumn')+theme(plot.title = element_text(size = 16, hjust = 0.5))
View(age.models)
View(d)
data = read.csv(file = '~/Downloads/monarchs_gbif.csv')
dat2 <- read.csv("~/Downloads/monarchs_gbif.csv", header=T, na.strings=c("","NA"))
head(dat2)
write.csv(dat2, '~/Desktop/monarchs_gbif.csv')
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae)
nrow(larvae)
larvae <- larvae[larvae$Gen=='F2',]
nrow(larvae)
library(ggplot2)
library(lme4)
aggregate(Mass ~ Pop + Host, mean, larvae)
str(larvae)
larvae <- larvae[larvae$Mass != "DNM",]
nrow(larvae)
larvae$Mass <- as.numeric(larvae$Mass)
is.na(larvae$Mass)
larvae$alive <- ifelse(is.na(larvae$Mass) == TRUE, 0, 1)
aggregate(alive ~ Host + Pop, mean, larvae)
larvae$alive
str(larvae)
is.data.frame(larvae)
aggregate(alive ~ Host + Pop, mean, data = larvae)
aggregate(alive ~ Host + Pop, FUN = mean, data = larvae)
larvae$alive
larvae$alive <- as.numeric(ifelse(is.na(larvae$Mass) == TRUE, 0, 1))
aggregate(alive ~ Host + Pop, FUN = mean, data = larvae)
str(larvae)
mean(c(1,0))
#
library(ggplot2)
library(lme4)
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
#First work through survival data
#remove rows that say 'DNM' and recode column as numeric
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
#remove secondary host plants
larvae <- larvae[larvae$Host %in% c('ASYR','ASCU'),]
larvae$Mass <- as.numeric(larvae$Mass)
larvae$alive <- as.numeric(ifelse(is.na(larvae$Mass) == TRUE, 0, 1))
nrow(larvae)
names(larvae)
surival.model <- lmer(alive ~ Host + Pop + (1|Mom) + (1|Plant), data = larvae, family = 'binomial')
surival.model <- lmer(alive ~ Host + Pop + (1|Mom) + (1|Plant), data = larvae,  'binomial')
surival.model <- glmer(alive ~ Host + Pop + (1|Mom) + (1|Plant), data = larvae,  family = 'binomial')
larvae$alive
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
larvae <- larvae[larvae$Host %in% c('ASYR','ASCU'),] #528 rows
is.na(larvae$Mass)
larvae$Mass <- as.numeric(larvae$Mass)
is.na(larvae$Mass)
larvae$Mass
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
larvae <- larvae[larvae$Host %in% c('ASYR','ASCU'),] #528 rows
larvae$Mass <- as.numeric(larvae$Mass)
larvae$Mass
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
larvae <- larvae[larvae$Host %in% c('ASYR','ASCU'),] #528 rows
larvae$Mass
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
larvae$Mass
larvae$Mass <- as.numeric(larvae$Mass)
larvae$Mass
larvae$alive <- as.numeric(ifelse(is.na(larvae$Mass) == TRUE, 0, 1))
larvae$alive
larvae <- larvae[larvae$Host %in% c('ASYR','ASCU'),] #528 rows
larvae$alive
#
library(ggplot2)
library(lme4)
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
#First work through survival data
#remove rows that say 'DNM' and recode column as numeric
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
#remove secondary host plants
larvae$Mass <- as.numeric(larvae$Mass)
larvae$alive <- as.numeric(ifelse(is.na(larvae$Mass) == TRUE, 0, 1))
surival.model <- glmer(alive ~ Host + Pop + (1|Mom) + (1|Plant), data = larvae,  family = 'binomial')
larvae$alive
mean(larvae$alive)
larvae$Host
#
library(ggplot2)
library(lme4)
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
#First work through survival data
#remove rows that say 'DNM' and recode column as numeric
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
#remove secondary host plants
larvae$Mass <- as.numeric(larvae$Mass)
larvae$alive <- as.numeric(ifelse(is.na(larvae$Mass) == TRUE, 0, 1))
larvae$Host
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
larvae$Host
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
larvae$Host
larvae <- larvae[larvae$Mass != "DNM",] #gets rid of 8 rows
larvae$Host
#
library(ggplot2)
library(lme4)
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
#First work through survival data
#remove rows that say 'DNM' and recode column as numeric
larvae <- larvae[!larvae$Mass == "DNM",] #gets rid of 8 rows
larvae$Host
#
library(ggplot2)
library(lme4)
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
#First work through survival data
#remove rows that say 'DNM' and recode column as numeric
df1 <- larvae[-larvae$Mass == "DNM",] #gets rid of 8 rows
df1 <- larvae[!larvae$Mass == "DNM",] #gets rid of 8 rows
df1
library(ggplot2)
library(lme4)
larvae <- read.csv('~/Downloads/caterpillar_data.csv')
head(larvae) #777 rows
larvae <- larvae[larvae$Gen=='F2',] #restrict to only F2s, gives 630 rows
larvae$Mass
larvae$alive <- as.numeric(ifelse(is.na(larvae$Mass) == TRUE, 0, 1))
aggregate(alive ~ Host + Pop, mean, larvae)
aggregate(alive ~ Host + Pop, mean, data = larvae)
larvae <- larvae[larvae$Host %in% c('ASYR','ASCU'),]
aggregate(alive ~ Host + Pop, mean, data = larvae)
survival.model <- lmer(alive ~ Pop + Host + (1|Mom) + (1|Plant), data = larvae, family = 'binomial')
survival.model <- glmer(alive ~ Pop + Host + (1|Mom) + (1|Plant), data = larvae, family = 'binomial')
summary(survival.model)
mass.model <- lmer(Mass ~ Pop + Host + (1|Mom) + (1|Plant), data = larvae)
summary(mass.model)
library(lmerTest)
summary(mass.model)
mass.model <- lmer(Mass ~ Pop + Host + (1|Mom) + (1|Plant), data = larvae)
summary(mass.model)
mass.model <- lmer(Mass ~ Pop*Host + (1|Mom) + (1|Plant), data = larvae)
summary(mass.model)
library(emmeans)
emmeans(mass.model, specs = ~Host*Pop)
plot.emm <- as.data.frame(emmeans(mass.model, specs = ~Host*Pop))
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)
summary(survival.model)
aggregate(alive ~ Host + Pop, mean, data = larvae)
table(larvae, Host + Pop)
table(with(larvae, Host + Pop))
table(with(larvae, Host, Pop))
table(with(larvae, Host*Pop))
table(with(larvae, Host~Pop))
table(with(larvae, c(Host,Pop)))
??table
table(larvae)
table(larvae$Host)
table(larvae$Host, larvae$Pop)
adults <- read.csv('~/Downloads/2021_Sequestration_Experiment - Adults.csv')
table(with(adults[adults$Gen==2,], Pop, Host))
adults <- adults[adults$Gen==2,]
table(adults$Host, adults$Pop)
207/311
135/173
22/28
27/37
22/29
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_light()
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_classic()
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw()
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point()+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw(base_size = 16)
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 5)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 5)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw(base_size = 16)
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 5)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw(base_size = 16)
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL))+
facet_wrap(~Host)+
theme_bw(base_size = 16)
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','turquoise','purple'))
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','gold','purple'))
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','gold','purple'))+
ylab('Larval Mass - Day 8 (g)')+
xlab('Population of Origin')+
theme(legend.position = element_blank())
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','gold','purple'))+
ylab('Larval Mass - Day 8 (g)')+
xlab('Population of Origin')+
theme(legend.position = NULL)
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','gold','purple'))+
ylab('Larval Mass - Day 8 (g)')+
xlab('Population of Origin')+
theme(legend.position = element_blank())
theme(legend.position = 'none'
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','gold','purple'))+
ylab('Larval Mass - Day 8 (g)')+
xlab('Population of Origin')+
theme(legend.position = 'none')
ggplot(plot.emm, aes(x = Pop, y = emmean, col = Pop))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
scale_color_manual(values = c('blue','gold','purple'))+
ylab('Larval Mass - Day 8 (g)')+
xlab('Population of Origin')+
theme(legend.position = 'none')
ggplot(plot.emm, aes(x = Pop, y = emmean))+
geom_point(size = 3)+
geom_errorbar(aes(ymin = lower.CL, ymax = upper.CL), width = 0.2)+
facet_wrap(~Host)+
theme_bw(base_size = 16)+
ylab('Larval Mass - Day 8 (g)')+
xlab('Population of Origin')+
theme(legend.position = 'none')
library(ggplot2)
library(lme4)
library(lmerTest)
cat.color <- read.csv(file = '~/Documents/UChicago/Monarch_Sequestration/Caterpillar Coloration/caterpillar coloration.csv')
head(cat.color)
cat.color <- cat.color[cat.color$Host != 'AINC',]
ggplot(cat.color[cat.color$Index!=172,], aes(x = Greyness, fill = Pop))+
geom_density()+
facet_wrap(~Index)
greyness.aggregated <- aggregate(Greyness ~ Index + Pop + Mom + Host, FUN = mean, cat.color)
max.value <- vector()
greyness.aggregated$length <- max.value
greyness.model <- lmer(Greyness ~ Pop + Host + (1|Mom) + length, data = greyness.aggregated)
summary(greyness.model)
Mom.Agg <- aggregate(Greyness ~ Mom + Host + Pop, data = greyness.aggregated, mean)
for(i in 1:length(unique(cat.color$Index))){
index.vec <- unique(cat.color$Index)
max.value[i] <- max(cat.color[cat.color$Index==index.vec[i],]$Distance)
}
ggplot(Mom.Agg, aes(x = Host, y = Greyness, group = Mom, col = Pop))+
geom_point()+
geom_line()
ggplot(Mom.Agg, aes(x = Host, y = Greyness, group = Mom, col = Pop))+
geom_point()+
geom_line()+
theme_bw(base_size = 16)
greyness.model <- lmer(Greyness ~ Pop + Host + (1|Mom) + length, data = greyness.aggregated)
max.value <- vector()
for(i in 1:length(unique(cat.color$Index))){
index.vec <- unique(cat.color$Index)
max.value[i] <- max(cat.color[cat.color$Index==index.vec[i],]$Distance)
}
greyness.aggregated$length <- max.value
greyness.model <- lmer(Greyness ~ Pop + Host + (1|Mom) + length, data = greyness.aggregated)
summary(greyness.model)
# pi, ho, private, fst, tajima's D
dat <- calc_pi(dat, "pop")
.libPaths(c(.libPaths(), "/home/hemstrow/R/x86_64-pc-linux-gnu-library/4.1", "/usr/local/lib/R/site-library", "/usr/lib/R/site-library", "/usr/lib/R/library", "/share/apps/rmodules"))
library(snpR);
args <- commandArgs(TRUE)
if(length(args) != 1){
cat("Usage: calc_stats.R input_snpRdata_file\n")
}
if(length(args) == 1){
input <- args[1]
outfile <- gsub(".RDS", "", input)
dat <- readRDS(input)
dat <- filter_snps(dat, hwe = 0.000001, hwe_facets = "pop", min_loci = 0.75)
# pi, ho, private, fst, tajima's D
dat <- calc_pi(dat, "pop")
dat <- calc_ho(dat, "pop")
dat <- calc_private(dat, "pop")
dat <- calc_het_hom_ratio(dat)
ss <- get.snpR.stats(dat, "pop", c("pi", "ho"))$weighted.means
ss <- na.omit(ss)
write.table(ss, paste0(outfile, "_processed_stats.txt"), sep = "\t", quote = F, col.names = TRUE, row.names = FALSE)
saveRDS(dat, paste0(outfile, "_processed.RDS"))
}
.libPaths(c(.libPaths(), "/home/hemstrow/R/x86_64-pc-linux-gnu-library/4.1", "/usr/local/lib/R/site-library", "/usr/lib/R/site-library", "/usr/lib/R/library", "/share/apps/rmodules"))
library(data.table); library(ggplot2); library(snpR);
wb <- openxlsx::createWorkbook(creator = "William Hemstrom")
openxlsx::addWorksheet(wb, "Basic Stats")
openxlsx::addWorksheet(wb, "Fst")
#==================tajima's D===============
# pull in data
flist <- list.files(path = "./results/paralogs/", "tajimas_D")
out <- vector("list", length(flist))
for(i in 1:length(flist)){
out[[i]]  <- data.table::fread(paste0("./results/paralogs/", flist[i]))
out[[i]]$pop <- substr(flist[i], 27, 29)
}
flist
setwd('~/Documents/GitHub/F-H_2018/')
#==================tajima's D===============
# pull in data
flist <- list.files(path = "./results/paralogs/", "tajimas_D")
flist
stickSNPs
calc_pi(stickSNPs)
get.snpR.stats(calc_pi(stickSNPs))
dd = get.snpR.stats(calc_pi(stickSNPs))
dd$pi
mean(dd$pi)
??calc_pi
dd = get.snpR.stats(calc_pi(stickSNPs))
dd$maf
genos <- source(file = '../F-H_2018/Raw_data/flt_snps_clean.RDS')
